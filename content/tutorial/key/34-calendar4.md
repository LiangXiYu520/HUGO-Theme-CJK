---
author: ["柯棋瀚"]
title: "赫赫金鑰｜中國古代曆法史"
date: 2021-02-24
lastmod: 2021-03-15
categories: ["史"]
series: ["赫赫金鑰"]
tags: ["厤筭"]
url: /tutorial/calendar4
description: '非常簡短地介紹一下中國古代曆法的歷史。本文各正史曆志簡稱<v>某志</v>，<v>開元占經</v>卷一〇五簡稱<v>占經</v>。有很多我個人的認識，錯訛不足之處敬請賜敎。【目錄】一、曆法更迭；二、曆法發展大勢；三、幾個問題'
img: 'https://pic.imgdb.cn/item/6034e8335f4313ce2553ed91.jpg'
vertical: false
---

## 一、曆法更迭

這一部分附上我的殘缺曆法復原思路。

### 1、

1. **三代**皆觀象授時。<u>堯</u>時一年爲365日。

2. **春秋晚期**產生推步曆法，此時的算法不可考。春秋時期的實行曆譜可以參考最新研究：郜積意<v>經學與曆學的貫通——春秋朔閏表與經文歷日考證</v><n><v>學術月刊</v>2020年1期</n>「晉魯曆不同，非周正夏正之差。魯曆與列國曆法互異，以置閏有殊，故月每差一月；以朔法不一，故日每差一日。」

3. **戰國**
   
   1. 戰國早期推步曆法走向成孰，產生了<v>殷曆</v>、<v>雨水元夏曆</v><n>如果有的話</n>。楚國也許用建丑<v>殷曆</v>。
   2. 戰國中期有<v>魯曆</v>、<v>顓頊曆</v>。
   3. 戰國晚期有<v>黃帝曆</v>、<v>周曆</v>、<v>夏曆</v>。<n>古六曆合天時間見廖育棟 [古六曆的計算方法](https://ytliu0.github.io/ChineseCalendar/guliuli_chinese.html)</n>
   
4. **秦至漢武帝**<v>顓頊</v>。根據出土材料，可以瞭解到顓頊曆經過了多次調整，分爲如下階段<n>據朱桂昌<v>顓頊日曆表</v>，中華書局2012，並且我自己調整了一個階段</n>。目前方案合於惠帝三年簡<n>張培瑜等<v>中國古代曆法</v>，中國科學技術出版社2008，頁247</n>。有一條不合：秦王政廿年前237，七月甲寅，<n>進餘3/4</n>卻是乙卯。
   1. <n>秦獻公十九年前366—秦武王四年前307</n>建寅，以寅月<n>冬至所在月爲子月</n>爲正月、爲年首，與漢代以後絕大多數曆法相同。
   2. <n>秦昭王元年前306—秦莊襄王三年前247</n>建寅，以寅月爲正月，以十月爲年首，卽一年十二個月的順序爲10-11<n>冬至月</n>-12-1-⋯-9。這就是標準的<v>顓頊曆</v>。
   3. <n>秦始皇元年前246—秦二世三年前207</n>小餘增加 3/4 日。
   4. <n>漢高帝元年前206—呂后三年前184</n>小餘在上一階段基礎上減去 210/940 日。<n>四分曆法一月爲 29+499/940日，940卽日法，見 [赫赫金鑰｜曆學二：古四分曆、三統曆](/tutorial/calendar2)</n>
   5. <n>呂后四年前183—文帝後元元年前163</n>變閏章，之前是固定冬至置閏法的閏章，現在是無中氣置閏法的閏章，但是閏月依然放在年末，卽後九月。
   6. 在上一階段基礎上退餘 25/940 日<n>文帝後元2年前162—武帝元封7年前104年4月</n>文帝後元二年。
   
5. **漢武帝至章帝**<u>鄧平</u><v>太初</v>、<v>曆術甲子篇</v><n>太初元年前104年5月—章帝元和二年85年正月</n>。這期間行<v>太初曆</v>，但可能也用<v>曆術甲子篇</v><n>見<v>史記</v>，爲古四分曆，我在<v>殷曆</v>基礎上減去朔餘3/4，以爲太初元年冬至朔旦夜半</n>作爲推步參考。太初改曆的內容：1、曆元從立春改爲年前朔旦冬至。2、正月爲歲首。3、行<u>鄧平</u>曆。4、歲末置閏改爲無中置閏。5、藉半日法：用途是<q>「月或朔見」</q>，其實就是承認後天半日。<n>見<v>中國古代曆法</v></n>

6. **漢章帝以後**<v>後漢四分</v><n>章帝元和二年85年2月—漢末</n>。

7. **三國兩晉**
   1. 蜀<n>221-263</n>以漢統自居，沿用<v>後漢四分</v>。
   2. <u>劉洪</u><v>乾象</v><n>吳黃武二年223—280吳亡</n>。<q>「二年春正月⋯⋯改四分，用乾象歷。」</q><n><v>三國志卷四七</v></n>另有魏<u>韓詡</u>造<v>黃初</v>，他批評<v>乾象</v>減斗分太過<n>回歸年太小</n>，不過實際上<q>「<u>韓翊</u>所造皆用<u>洪</u>法，小益斗下分，所錯無幾。」</q><n>我據占經復原<v>黃初</v>，月離表以<v>乾象</v>補之</n>
   3. <u>楊偉</u><v>景初</v><n>魏明帝景初元年237—終晉沿用<v>景初</v>—劉宋<v>元嘉</v>行用之前</n>。另有晉武帝泰始十年<n>274</n><u>劉智</u><v>正曆</v><n>我據占經、宋志復原，月離表以<v>景初</v>補之</n>。永和八年<n>352</n><u>王朔之</u><v>通曆</v>，<v>宋志</v>：<q>「王朔之以其上元歲在甲子，善其術，欲以九萬七千歲之甲子爲開闢之始，何承天云『悼於立意者也。』」</q>這麼說積年97000沒問題，但算出來有問題，我就調整了積年，月離表以<v>景初</v>補之。
   
8. **南朝**
   1. <u>何承天</u><v>元嘉</v><n>宋元嘉廿二年445—509</n>。
   2. 祖沖之<v>大明</v><n>梁武帝天監九年510—陳亡589</n>。經過<u>祖沖之</u>之子<u>祖暅</u>力爭，得以行用。
   
9. **北朝**<n>參考 [廖育棟](https://ytliu0.github.io/ChineseCalendar/NorthSouth_Calendars_chinese.html)</n>
   1. **後秦<n>384—417</n>**<u>姜岌</u><v>三紀甲子元</v>。我據晉志下、占經復原，月離表以<v>景初</v>補之。
   2. **北涼<n>397—439</n>**<u>趙𢾺</u><v>玄始</v><n>玄始元年412—北涼亡</n>。我據占經、<v>疇人傳</v>卷六復原。
   3. **北魏<n>386—534</n>**
      1. <v>景初</v><n>建都平城398—451</n>。
      2. <v>玄始</v><n>文成帝興安元年452—522</n>
      3. <u>張龍祥</u><u>李業興</u>等九家綜合而成<v>正光</v><n>孝明帝正光四年523—558</n>。
   4. **東魏<n>534—550</n>**<u>李業興</u><v>興和</v><n>興和二年540—亡</n>。算法全襲正光，僅參數不同。
   5. **北齊<n>550—577</n>**<u>宋景業</u><v>天保</v><n>天保二年551—亡</n>，月離表據嚴敦傑<v>補北齊書曆志</v><n><v>自然科學史研究</v>1984年第3期</n>補之。另有<u>董峻</u>、<u>鄭元偉</u><v>甲寅元</v>，據嚴敦傑<v>補北齊書曆志</v>補之，月離表以<v>天保</v>補之。
   6. **西魏<n>535—557</n>** 沿用<v>正光</v>。
   7. **北周<n>557—581</n>**
      1. <v>明克讓</v><n>武成元年559—565</n>。我用占經的<v>梁武大同</v>來補<v>明克讓</v>。不是很清楚這個梁武大同是什麼，可能跟明克讓沒什麼關係。<v>隋志中</v>：<q>「初，西魏入關，尚行李業興<v>正光術</v>。至武成元年，始詔克讓與麟趾學士庾季才及諸日者定新術，采<u>祖暅</u>舊議，通簡南北之術。自斯已後，頗親其謬。故周齊並時，而曆差一日。」</q><n>陳久金<v>符天曆研究</v>：<u>祖暅</u>的<v>符天經</v>與後來的<v>符天曆</v>毫無關係。</n>也就是說<v>明克讓</v>綜合南北算法，跟<v>天保</v>差了一天。我復原後運行程序，大約三年中有兩年會有一個月會差一天，很符合記載。
      2. <u>甄鸞</u><v>天和</v><n>天和元年566—578</n>，月離表以<v>天保</v>補之。
      3. <u>馬顯</u>丙寅元<v>大象</v><n>大象元年579—583</n>，月離表以<v>天保</v>補之。<v>通占大象曆星經</v>與大象曆配套使用，可能是張賔所作<n>許潔<v>隋唐時期的道教星象研究</v>，<v>宗教學研究</v>2009年第4期，第29頁</n>，也許可以用來復原大象曆。<v>隋書張冑玄傳</v>：<q>「周马显造 <v>丙寅元历</v>，有阴阳转法，加减章分，进退蚀余，乃推定日，创开此数。当时术者，多不能晓。张宾因而用之，莫能考正。」</q><v>隋書</v>：<q>「小周餘、盈縮積，其曆術別推入蔀會，分用陽率499，陰率9。每12月下各有日月蝕轉分，推步加減之，乃爲定蝕大小餘，而求加時之正。」</q>
   
10. **隋**<n>581—618</n>
    1. <u>張賔</u><v>開皇</v><n>隋開皇四年584—開皇十六年596</n>，以<v>元嘉</v>、<v>大象</v>爲基礎，得以行用。月離表闕，我以<v>天保</v>補之。劉孝孫批評<v>張賔曆</v>粗疏，劉孝孫被罷。劉孝孫死後，楊素等舉薦<u>張冑玄</u>。
    2. <u>張冑玄</u><v>大業</v><n>開皇十七年597—亡</n>。另有<v>張孟賓</v><n><u>張孟賔</u>和<u>張賔</u>是兩個人</n>、<v>甲子元劉孝孫</v>，二人同爲張子信門生。二曆以占經復原，月離、日躔以<v>皇極</v>補之，用<v>皇極</v>二次差內插算法。劉焯採<v>劉孝孫</v>，稍損益以爲<v>皇極</v>，與<v>大業</v>頗有參差，最終<v>大業</v>得以行用。這一時期的紛紜可以參考王荣彬 [隋初改历之争](https://www.mmzy.org.cn/qunyan/pmjl/201811/81247.aspx)。
    
11. **唐**
    1. <u>傅仁均</u><v>戊寅元</v><n>高祖武德二年619—664</n>。<v>新唐志一</v>：<q>「仁均曆有三大、三小，云日月之蝕，必在朔望。十九年九月後，四朔頻大。」</q><u>李淳風</u>：<q>「古曆分日起於子半。⋯⋯<u>傅仁均</u>子初爲朔」</q>。另有高宗顯慶年間<n>656—661</n>印度曆法<v>九執</v>，全文見占經卷一〇四，我據顧觀光<v>九執曆解</v><n><v>武陵山人遺書</v>，<v>中國科學技術典籍通匯</v>天文部分843頁</n>勉強復原。我沒怎麼遵照原始的算法，只是用正弦算日月盈縮。
    2. <u>李淳風</u><v>麟德</v><n>高宗麟德二年665—728</n>。發明進朔，景龍二年708—開元四年716、開元九年721—十六年728用進朔法推排。<n>見黃一農<v>中國史曆表朔閏訂正舉隅———以唐麟德曆行用時期爲例</v>，<v>漢學研究</v>1992年2期，頁291—296</n>
    3. <u>一行</u><v>大衍</v><n>玄宗開元十七年729—757</n>。有所謂<q>「<v>大衍</v>寫<v>九執</v>」</q>公案。
    4. <v>至德</v><n>乾元元年758—上元三年762</n>。算法全襲<v>大衍</v>，節氣推後二日，我據此復原<v>至德</v>。
    5. <u>郭獻之</u><v>五紀</v><n>肅宗寶應元年762—783</n>
    6. <v>正元</v><n>德宗興元元年784—806</n>。<v>五紀</v>、<v>正元</v>綜合<v>大衍</v>、<v>麟德</v>，唯唯而已。憲宗即位，<u>徐昂</u>上<v>觀象曆</v>，失載。
    7. <u>徐昂</u><v>宣明</v><n>穆宗元和二年807—892</n>。<v>宣明</v>晷漏、交會稍增損，更立新術以步五星，其餘沿襲<v>大衍</v>。
    8. <u>邊岡</u><v>崇玄</v><n>昭宗景福二年893—950</n>。 另有術士<u>曹士蔿</u><v>符天</v><n>780-820</n>，乃民間小曆，以<q>「相減相乘法」</q>代躔離表，日法用萬分，曆元用雨水，以定氣注曆。<v>崇玄</v>本於<v>大衍</v>，而巧算源自<v>符天</v>。
    
12. **五代<n>907—960</n>**
    1. **梁、唐、漢**沿用<v>崇玄</v>。
    2. **晉**<u>馬重績</u><v>乙未元調元</v><n>天福五年940—946</n><v>新五代志</v>：<q>「以宣明之氣朔合崇元之五星，二曆相參，然後符合。」</q>失傳，以我復原的<v>符天</v>代之，參數暫用<v>崇玄</v>，算法用相減相乘法。<n>算法見陳久金<v>符天曆研究</v></n>
    3. **周<n>951—960</n>**<u>王樸</u><v>欽天</v><n>後周顯德三年956—周亡，宋初960—963沿用</n>沿用。躔離五星表不存，以<v>崇玄</v>補之。
    
13. **契丹遼<n>907—1125</n>**<n>參 [廖育棟](https://ytliu0.github.io/ChineseCalendar/LiaoJinYuan_Calendars_chinese.html)</n>

    1. <u>馬重績</u><v>調元曆</v><n>應曆十一年961司天王白、李正等進曆—993</n>。劉義叟見到調元原文，其<v>長曆</v>可信<n>見邱靖嘉<v>遼史曆象志溯源</v>，<v>中華文史論叢</v>2012第4期</n>，那麼接下來的工作就是以我復原的核對<v>長曆</v>。
    2. <u>賈俊</u><v>大明</v><n>統和十二年994—亡</n>。失傳，以<v>宣明</v>代之。<v>遼志下</v>的這段記載比較胡扯：

       > 遼、漢、周、宋，俱行夏時，各自爲曆。國史閏朔，頗有異同。遼初用乙未元曆，本何承天元嘉曆法；後用大明曆，本祖冲之甲子元曆法。承天日食晦朏，一章必七閏；冲之日食必朔，或四年一閏。用乙未曆，漢、周多同；用大明曆，則間與宋異。國史敍事，甲子不殊，閏朔多異，以此故也。耶律儼紀以大明法追正乙未月朔，又與陳大任紀時或牴牾。

       遼金的曆法和<v>元嘉</v>、<v>祖沖之</v>風馬牛不相及。

14. **金<n>1115—1234</n>**

    1. <u>楊級</u><v>大明</v><n>天會十五年1137—1181</n>
    2. <u>趙知微</u><v>重修大明</v><n>大定廿二年1182—亡，蒙古沿用至1281<v>授時</v></n>

15. **宋<n>960—1279</n>**

    1. 王處訥<v>應天</v><n>964—982</n>建隆四年963成。宋代行用時間見<v>中國古代曆法</v>第606頁
    2. 吳昭素、徐瑩、董昭吉各上新曆，最後用<u>吳昭素</u><v>乾元</v><n>983—1000</n>。
    3. <u>史序</u><v>儀天</v><n>1001—1023</n>。
    4. <u>宋行古</u><v>崇天</v><n>1024—1064，中間用<v>明天</v>，後又用<v>崇天</v>1068—1074</n>。
    5. <v>明天</v><n>1065—1067</n>。歷史背景見董煜宇<v>从奉元历改革看北宋天文管理的绩效</v><n><v>自然科學史研究</v>2008年2期</n>
    6. <u>沈括</u>、<u>衛樸</u><v>奉元</v><n>1075—1093</n>不存，以<v>觀天</v>代之。
    7. <v>觀天</v><n>1094—1102</n>。
    8. <v>占天</v><n>1103—1105</n>，失傳。
    9. <v>紀元</v><n>1106—1127</n>。南宋定朔算法全同<v>紀元</v>，除了<v>統天</v>用歲實消長。<n>滕豔輝<v>宋代朔閏與交食研究</v>，2012西北大學科技史博士論文，52頁</n>
    10. 失載<n>1128—1135</n>，以<v>紀元</v>代之。
    11. <v>統元</v><n>1136—1167</n>。<v>疇人傳</v><v>陳得一</v>的一段內容可以作爲兩宋之際曆法復原的參考：

        > 南渡以後，星翁離散，<v>紀元術</v>亡。紹興二年，高宗重購得之。六月甲午，語輔臣曰：『術官推步不精，今術差一日，近得<v>紀元術</v>，自明年當改正。協時月正日，蓋非細事。』五年，日官言：『正月朔旦日食九分半，虧在辰正。』得一言：『當食八分半，虧在巳初。』其言卒驗。侍御史張致遠言：『今歲正月朔日食，太史所定不驗，得一嘗爲臣言，皆有依據。蓋患算造者不能通消息盈虛之奧、進退遲疾之分，致立朔有訛。凡定朔小餘七千五百以上者，進一日。紹興四年十二月小餘七千六百八十，太史不進，故十一月小盡；今年五月小餘七千一百八十，少三百二十，乃爲進朔，四月大盡。建炎三年定十一月三十日甲戌爲臘。<v>陰陽書</v>曰：<q>「臘者，接也。」</q>以故接新，在十二月近大寒前後戌日定之，若近大寒戌日在正月十一日，若即用遠大寒戌日定之，庶不出十二月。如宣和五年十一月二十七日丙午大寒，後四日庚戌，雖近，緣在六年正月一日，此時以十九日戊戌爲臘。得一於歲旦日食，嘗預言之，不差釐刻。願詔<u>得一</u>改造新秝，委官專重其事，仍盡取其書，參校太史有無，以補遺闕。擇秝算子弟粗通了者，授演撰之要，庶幾日官無曠，秝法不絕。』二月丙子，詔祕書少監朱震即祕書省監視得一改造新秝。八月秝成，震請賜名<v>統元</v>，從之。

    12. <v>乾道</v><n>1168—1176</n>
    13. <v>淳熙</v><n>1177—1190</n>
    14. <v>會元</v><n>1191—1198</n>
    15. <v>統天</v><n>1199—1207、1208—1251</n><v>開禧</v>期間與<v>統天</v>並推。
    16. <v>開禧</v><n>1208—1251</n>
    17. <v>淳祐</v><n>1252—1252</n>失傳，以<v>成天</v>代之。
    18. <v>會天</v><n>1253—1270</n>失傳，以<v>成天</v>代之。
    19. <v>成天</v><n>1271—1276</n>
    20. <v>本天</v><n>1277—1279</n>失傳，以<v>成天</v>代之。

16. **元<n>1206—1370</n>**<u>郭守敬</u>等<v>授時</v><n>1281—1367</n>。

17. **明<n>1368—1644</n>**<v>大統</v><n>1368—1662</n>。<v>大統</v>全襲<v>授時</v>，只是取消歲實消長；用 /(月實行-日平行) 取代 /(月實行)。但是據<v>大統曆書</v>，依然用的是<v>授時</v>的 /(月實行)。<n>見 廖育棟 [明朝<v>大統曆</v>的定朔計算及曆表朔日訂正](https://ytliu0.github.io/ChineseCalendar/MingCalendar_chinese.html)</n>

18. **清<n>1644—1911</n>**	   

    1. <v>西洋新法曆書</v><n>1645—1679</n>
    2. <v>康熙永年曆法</v><n>1680—1726</n>
    3. <v>曆象考成</v><n>1727—1733</n>
    4. <v>曆象考成後編</v><n>1734—1913</n>

### 2、

漢代以後皆行寅正，但也有幾次改正朔事件：

1. 王莽始建國元年9，改行建丑，將去年十二月改爲今年正月。劉玄更始元年23，復行建寅，將年末的丑月改爲十三月，也就是說公元24年正式用建寅。
2. 魏明帝景初元年237，改行建丑，將三月改爲四月。但<q>「郊祀、迎氣，祭祠、烝嘗，巡狩、蒐田，分至啓閉，班宣時令，皆以建寅爲正。」</q>景初三年正月，明帝崩，復行建寅。<n><v>宋書志中</v></n>
3. 武周時期689十二月行建寅，以子月爲年首<n>如同<v>顓頊</v>建寅，以亥月爲年首</n>：正月—十二月—一月—二月⋯⋯十月。689年只有11個月<n>其中一個月是閏月</n>。長安元年701二月復行以寅月爲年首。700年有15個月<n>其中一個月是閏月</n>。
4. 肅宗761十二月改行建子。此年只有10個月。762年四月復行建寅。此年有14個月，有2個四月<n>卯月巳月</n>和2個五月<n>辰月午月</n>。<n>見廖育棟 [中國歷代朔閏表](https://ytliu0.github.io/ChineseCalendar/table_chinese.html)</n>

## 二、曆法發展大勢

- 曆法史的第一次重大變革是戰國初期古四分曆出現，標誌著曆法從觀象授時走向推步。
- 第二次是<v>太初曆</v>，開創了諸多重要議題。
- 第三次是漢末<v>乾象</v>，歲實朔策突破四分曆框架，加上月行遲疾，發明定朔推算的方法，用以步日月食。
- 第四次是祖沖之<v>大明</v>，增歲差<n>恆星年與回歸年之差</n>，破章法<n>改變19年7閏的古閏章</n>，此後每曆都有不同的章法。
- 第五次是劉焯<v>皇極</v>，這一次稍顯複雜。後魏末年，張子信避亂海島，發現日行盈縮，門人劉孝孫、張孟賔用之於曆，推日食超於鄭元偉董峻之<v>甲寅</v>、宋景業之<v>天保</v>。次年北齊亡於北周，劉孝孫、張孟賔曆未得行用。現在見到最早的日行遲疾表是張冑玄<v>大業</v>，但是與後世日躔表完全不同，<v>大業</v>的日行遲疾只能直接加在定朔上，不能用於推算定氣。到了<v>皇極</v>會古通今，引入<q>「日行盈縮、交道表裏、五星遲疾」</q><n><v>疇人傳</v>序</n>，有了成孰的日躔表，可以計算定氣，發明二次差內插，此後唐宋曆法都不出<v>皇極</v>框架。唐宋一些節點性質的曆法都各有發明。如<v>麟德</v><q>「廢章蔀紀元，而用總法」</q><n><v>疇人傳</v>序</n>，閏章的槩念徹底退出曆法。<v>大衍</v>將二次內插推廣至不等間距，將月亮視差固定爲表格，發明不同緯度的晷漏求法<n><v>中國古代曆法</v>第552頁</n>。<v>崇玄</v>引入<v>符天</v>的<q>「相減相乘法」</q>，計算五星遲疾等。<v>明天</v>將所有計算全部公式化。<v>統天</v>用歲實消長、朔實消長。
- 第六次是<v>授時</v>，幾乎快到陰陽曆的終點了。<v>授時</v>全面用公式，這一點源於<v>明天</v>；各項參數都用小數點，不用傳統的分數，廢調日法，源於天竺曆法；歲實消長、取消上元積年源於<v>統天</v>——可謂集大成。
- 第七次是清代<v>時憲</v>，底層更換爲西法，用定氣注曆。

有了以上認識，我們可以將古曆分爲以下系統：

- 四分系：從古六曆到<v>後漢四分曆</v>
- 魏晉系：從<u>劉洪</u><v>乾象</v>到<u>姜岌</u><v>三紀</v>
- 北朝系：從<v>玄始</v>到張賔<v>開皇</v>
- 南朝系：從<v>元嘉</v>到初唐<v>戊寅</v>
- 隋系：<v>劉孝孫</v>、<v>張孟賔</v>、<v>皇極</v>、<v>麟德</v>
- 天竺系：<v>神龍</v>、<v>九執</v>、<v>符天</v>
- 唐系：<v>大衍</v>到<v>欽天</v>
- 宋系：兩宋二十部曆法
- 授時系：<v>授時</v>、<v>大統</v>
- 時憲系：清代四部曆書

<b>四分質樸，魏晉古茂，北系鈍拙，南系超捷，隋系煌煌，唐系赫赫，宋系唯唯，授時集大成，時憲脫胎換骨。</b>北系沒有歲差，恢復了古曆的統法蔀法，與同時期的南系相比非常落後。<v>乾象</v>刱調日法<n>詳見後</n>，我稱其爲<u>古法</u>。隋至唐初是三系交錯的時候，這期間行用的四部曆法：<v>開皇</v>—<v>大業</v>—<v>戊寅</v>—<n><v>皇極</v>、</n><v>麟德</v>分別是北系<n><v>開皇</v>源自<v>大象</v></n>—南系<n><v>大業</v>師法祖沖之，又用日行遲疾</n>—南系<n><v>戊寅</v>源自<v>大業</v></n>—隋系<n><v>麟德</v>以<v>皇極</v>爲基礎</n>，最終隋系獲勝，過渡到<v>大衍</v>開創的唐系。唐系大量吸收天竺系的精神，到唐末<v>崇玄</v>始用公式，直接引導了宋系的公式化進程。宋系沒有什麼大的刱新，幾部公式化較高的曆法是其亮點。<u>古法</u>至於宋系而衰亂，歲實朔策大量出現小數點，積年動輒千萬年，古法實際只剩空殼，但宋人不思進取，直到<v>授時</v>纔廢除<u>古法</u>，是爲一恨；<v>明天</v>一度全面公式化，只可惜後來的宋人並不接受，依然用躔離表，是又爲一恨！此後便是古代最優秀的曆法<v>授時</v>了。

## 三、幾個問題

### 上元積年

宋以前皆有上元積年，雖有<v>戊寅</v>、<v>明天</v>的短暫停用，但直到<v>授時</v>纔徹底廢除。根據我粗畧的觀察，漢代的上元積年是回歸年、朔望月、交食週期、五星週期的同餘數，魏晉系、北系是回歸年、朔望月的同餘數，南系是回歸年、朔望月、交食週期、近點月。關於上元積年也有相關學術討論，可以參考。

<v>後漢四分</v>的上元積年是 270 多萬年，古六曆也是差不多是這樣，所以可以判定古六曆的上元積年一定是漢代的，戰國時期的古六曆應該沒有考慮五星週期，也沒有考慮年干支，直以 1520 年爲一週期。這只是我的猜測。

### 置閏法

漢代以後皆用無中氣置閏法，卽沒有中氣的那個月置爲閏月。<v>太初</v>有一個特殊的置閏規則：<q>「中氣在朔若二日，則前月閏」</q>，但這條規則貫徹得並不徹底，有些前月朔，有些沒有前月朔，所以我的程序並沒有設置這條規則。<n>見斯琴畢力格等<v>太初曆特殊置閏問題</v>，<v>內師大學報</v>2007年第6期，頁748—753</n>

而先秦古六曆的置閏法並不清楚，有閏餘法、固定冬至法、無中法三種可能。他們的原理見 [大小月、無中氣置閏圖；固定冬至、無中氣置閏圖](/post/midterm-leap)。

### 調日法

宋<v>明天</v>作者<u>周琮</u>論調日法曰：

> 自漢太初至于今，冬至差十日，如劉歆三統復強於古，故先儒謂之最疏。後漢劉洪考驗四分，於天不合，乃減朔餘，苟合時用。自是已降，率意加減，以造日法。宋世何承天更以四十九分之二十六爲強率，十七分之九爲弱率，於強弱之際以求日法。承天日法七百五十二，得一十五強，一弱。自後治曆者，莫不因承天法，累強弱之數，皆不悟日月有自然合會之數。
>
> 今稍悟其失，定新曆以三萬九千爲日法，六百二十四萬爲度母，九千五百爲斗分，二萬六百九十三爲朔餘，可以上𥡴於古，下驗於今，反覆推求，若應繩準。又以二百三十萬一千爲月行之餘<n>月行十三度之餘</n>，以一百六十萬四百四十七爲日行之餘<n>日行周天之餘</n>。乃會日月之行，以盈不足平之，幷盈不足，是爲一朔之法<n>日法也，名元法</n>。今乃以大月乘不足之數，以小月乘盈行之分，平而幷之，是爲一朔之實<n>周天分也</n>。以法約實，得日月相會之數，皆以等數約之，悉得今有之數<n>盈爲朔虛，不足爲朔餘</n>。又二法相乘爲本母，各母互乘，以減周天，餘則歲差生焉，亦以等數約之，卽得歲差、度母、周天實用之數。此之一法，理極幽眇，所謂反覆相求，潛遁相通，數有冥符，法有偶會，古曆家皆所未達<n>以等數約之，得三萬九千爲元法，九千五百爲斗分，二萬六百九十三爲朔餘，六百二十四萬爲日度母，二十二億七千九百二十萬四百四十七爲周天分，八萬四百四十七爲歲差</n>。<n>上<v>宋志七</v></n>

何承天以 26/47 爲強率，以 9/17 爲弱率，朔餘 / 日法 爲 (26m+9n)/(49m+17n) ，m 卽陽率<n>強數</n>，n 卽陰率<n>弱數</n>。調日法是南系、隋系、唐系、宋系的不傳之祕，直到乾嘉時期李銳纔闡明此法。<n>詳見 劉鈍《李銳、顧觀光調日法工作述評》，《自然科學史研究》1987(2)；陳久金《調日法研究》1984(3)</n>

以下是各曆朔餘、日法：

```javascript
[
    [43, 81], // 三統 大於強率
    [499, 940], // 四分 大於強率
    [773, 1457], // 乾象
    [6409, 12079], // 黃初
    [2419, 4559], // 景初
    [18703, 35250], // 正曆 李銳求不出
    [3217, 6063], // 三紀
    [47251, 89052], // 玄始 李銳求不出
    [399, 752], // 元嘉
    [2090, 3939], // 大明
    [815, 1536], // 大同
    [39769, 74952], // 正光 李銳求不出
    [110647, 208530], // 興和 李銳求不出
    [607, 1144], // 劉孝孫大業
    [155272, 292635], // 天保 李銳求不出
    [153961, 290160], // 天和 李銳求不出
    [28422, 53563], // 大象 大於強率
    [96529, 181920], // 開皇 大於強率
    [659, 1242], // 皇極
    [6901, 13006], // 戊寅
    [53.06, 100], // 神龍 累強弱求不出 李銳說不合，我求得出（因為乘了100）
    [711, 1340], // 麟德五紀
    [1613, 3040], // 大衍
    [581, 1095], // 正元
    [4457, 8400], // 宣明
    [7163, 13500], // 崇玄
    [3820.28, 7200], // 欽天 累強弱求不出 李銳求不出
    [5307, 10002], // 應天 累強弱求不出
    [1560, 2940], // 乾元 累強弱求不出
    [5359, 10100], // 儀天
    [5619, 10590], // 崇天 累強弱求不出
    [20693, 39000], // 明天
    [12575, 23700], // 奉元 累強弱求不出
    [6383, 12030], // 觀天
    [14899, 28080], // 占天
    [3868, 7290], // 紀元 累強弱求不出。陳久金：27076/51030
    [3677, 6930], // 統元
    [15917.76, 30000], // 乾道 累強弱求不出 李銳求不出。李繼閔說李銳說不合的原因是小數而非整數，自然不能用調日法，但是如果不用，又是怎麼求的？
    [2992.56, 5640], // 淳熙 累強弱求不出 李銳求不出
    [20534, 38700], // 會元 累強弱求不出
    [6368, 12000], // 統天 大於強率。按照調日法求出來是6367，加上了朔實消長
    [8967, 16900], // 開禧。以弱換強：16900=169*49+507*17=339*49+17*17=(169+17*10)*49+(507-49*10)*17
    [1873, 3530], // 淳祐
    [5168, 9740], // 會天 累強弱求不出
    [3937, 7420], // 成天
    [2775, 5230], // 大明 累強弱求不出
    [10978, 20690], // 乙未 累強弱求不出
    [5305.93, 10000], // 授時 累強弱求不出 李銳求不出
]
```

累強弱法剛寫出來的時候把各曆都算了一遍，上面是<b>當時</b>的情況，發現欽天以後大量朔餘用累強弱之數法算不出來。後來寫了分解公因數程序，突然發現這些求不出來的全都是可以通分的，通分之後就都求出來了！看來宋曆的 朔餘 / 日法 還照顧了其他因素。而李銳公式求不出的，我通分之後依然求不出。

### 日躔月離

自<v>乾象</v>始有月行遲疾，自<v>大業</v>始有日行盈縮，月離表、日躔表卽用來記錄每日、每氣的日月實行情況。表格的數據是離散的，所以要用內插法來計算特定時刻的日月實行。自<v>乾象</v>到<v>大業</v>、<v>戊寅</v>皆用線性內插，<v>皇極</v>始用二次差內插，到<v>授時</v>用三次公式。

- <v>隋志中</v>說張賔<v>開皇</v><q>「減朓就朒」</q>，我想<q>「朓朒」</q>一詞就是張賔開始用的，隨後劉焯<v>皇極</v>沿用，成爲盈縮積的替代說法。
- 中國的傳統都是近地點爲一個近點月的開始，但也有幾個例外，<v>神龍</v>、<v>大衍</v>、<v>宣明</v>、<v>崇玄</v>、<v>崇天</v>等以遠地點爲始。<v>神龍</v>受到天竺曆法的影響，開創用遠地點的先例。

古代沒有負數運算的槩念，所以遇到負數都要轉換爲正數，朓朒的正負問題詳見張培瑜等<v>中國古代曆法</v>470頁。但是要區別對待不同曆法的正負問題非常麻煩，所以我統一思路，所有曆法的正負都是這樣的：

<img src="https://pic.imgdb.cn/item/6035ec7d5f4313ce25bddf96.jpg">

精確的日月改正算法是：(日盈縮積 - 月朓朒積) / (月實行速 - 日實行速) 。這其實是一個簡單的 t = v / s 問題，不用管正負。現代計算通過迭代逐漸逼近精確的定朔時刻，一般迭代五次就夠了，古代沒有那麼大算力，都只進行一到兩次計算。<n>現代定朔、交食計算可參考<v>中國古代曆法第570頁左右。</n>那麼古曆日月改正數的算法可以統一爲這樣<n>加〔六角括號〕的是不同曆法或有或無</n>：

1. 日盈縮積或月朓朒積 = 整日朓朒積 + 該日損益率 * 比例<n>比例通過一次或二次內插算得</n>
2. 日或月實行速 = 整日月實行速 + 〔列差*比例〕
3. 改正數 = (〔日盈縮積〕- 月朓朒積) / (月實行速<n>或月平行速</n> - 〔日平行速〕)

魏晉系是 /月實行速，北系是 /月平行速，只有大業是 /(月實行-日平行)，隋唐系反而退步，都是 /月平行。<n>另可見<v>中國古代曆法</v>第434頁</n>

宋曆中，<v>觀天</v>、<v>儀天</v>用公式計算日行，<v>明天</v>全用公式計算。

### 日月食

漢代以前，只能根據交食週期確定是否有可能出現日月食。魏晉時期，可以計算食分多少，判斷交食程度。到<v>大業</v>，可以憑藉交道表裏篩掉一半的日食<n>月在黃道外則無日食，在內則有</n>。

唐宋時期交食計算稍有不驗，就要更換新曆了，在這樣的預測水平下，爲何日食依然是上天的警示？周琮說：<q>「今以日行之所盈縮、月行之所遲疾，皆損益之，或進退其日，以爲定朔，則舒亟之度，乃勢數使然，非失政之致也。」</q><q>「日食當朔，月食當望，蓋自然之理。夫日之食，蓋天之垂誡，警悟時政，若道化得中，則變咎爲祥。國家務以至公理天下，不可私移晦朔，宜順天誡。」</q>宋人已經認識到交食是一種自然現象，並非因爲<q>「失政」</q>，但日食依然是不好的事情，所以每逢日食，君主就要修身理政，以<q>「變咎爲祥」</q>。如果預測不準，那就會讓君主錯過上天的警示。我勉強能想到這樣理解。

<v>明志一</v>：

> 十九年三月癸巳朔，臺官言日當食，已而不食。帝喜，以爲天眷，然實由推步之疏也

看來預測日食還有這個作用：如果預測會發生但並未發生，說明上天眷顧，是好事。

### 進朔

唐代以前都是平朔注曆，戊寅曆始用定朔注曆，但李淳風說645年有四月連大，<q>「庚子，詔用仁均平朔」</q>，又暫停了用定朔注曆，直到<v>麟德</v>纔固定用定朔。雖然<v>皇極</v>就發明了二次內插，但唐宋時期編排曆書依然用簡單的線性內插，精確的二次差只用於交食推算。用定朔注曆，就會出現四月連大現象，還有閏月不好放置的問題，所以<v>麟德</v>提出進朔法作爲解決方案，此後唐宋閒沿用進朔法<n>我不清楚<v>授時</v>是否進朔</n>。幾部曆法的進朔規則：

- <v>宣明</v>：秋分—春分：0.75，夏至0.74005，清明0.74924，小暑0.74031，穀雨0.74479，大暑0.74124，立夏0.74276，立秋0.74276，小滿0.74124，處暑0.74479，芒種0.74031，白露0.74924。<n><v>中國古代曆法</v>第570頁</n>
- <v>明天</v>：秋分—春分：0.75。<q>「若春分後，其定朔晨分差如春分之日者，三約之，以減四分之三；如定朔小餘及此數已上者，進一日；朔或當交有食，初虧在日入已前者，其朔不進。弦、望定小餘不滿日出分者，退一日；其望或當交有食，初虧在日出已前，其定望小餘雖滿日出分者，亦退之。又月行九道遲疾，曆有三大二小；日行盈縮累增損之，則有四大三小，理數然也。若循其常，則當察加時早晚，隨其所近而進退之，使月之大小不過連三。」</q><n><v>宋代朔閏與交食研究</v></n>

我暫時都用簡單的 0.75。

### 赤道宿度

#### 赤度表

先秦時期的赤道宿度已不可俱考，但是出土材料能提供很多線索。到太初改曆，赤道宿度就固定下來了：

```javascript
    [12, '角'], // 1 東宮 總75
    [9, '亢'], // 2
    [15, '氐'], // 3
    [5, '房'], // 4
    [5, '心'], // 5
    [18, '尾'], // 6
    [11, '箕'], // 7
    [26, '斗'], // 8 北宮 總98
    [8, '牛'], // 9
    [12, '女'], // 10
    [10, '虛'], // 11
    [17, '危'], // 12
    [16, '室'], // 13
    [9, '壁'], // 14
    [16, '奎'], // 15 西宮 總80
    [12, '婁'], // 16
    [14, '胃'], // 17
    [11, '昴'], // 18
    [16, '畢'], // 19
    [2, '觜'], // 20
    [9, '參'], // 21
    [33, '井'], // 22 南宮 總112
    [4, '鬼'], // 23
    [15, '柳'], // 24
    [7, '星'], // 25
    [18, '張'], // 26
    [18, '翼'], // 27
    [17, '軫'], // 28
```

<v>太初</v>的赤度一直沿用到唐初。<v>大衍</v>重新制定了一份赤度表：

```javascript
    [12, '角'], // 1 東蒼龍
    [9, '亢'], // 2
    [15, '氐'], // 3
    [5, '房'], // 4
    [5, '心'], // 5
    [18, '尾'], // 6
    [11, '箕'], // 7
    [26, '斗'], // 8 北玄武
    [8, '牛'], // 9
    [12, '女'], // 10
    [10, '虛'], // 11
    [17, '危'], // 12
    [16, '室'], // 13
    [9, '壁'], // 14
    [16, '奎'], // 15 西白虎
    [12, '婁'], // 16
    [14, '胃'], // 17
    [11, '昴'], // 18
    [17, '畢'], // 19
    [1, '觜'], // 20
    [10, '參'], // 21
    [33, '井'], // 22 南朱雀
    [3, '鬼'], // 23
    [15, '柳'], // 24
    [7, '星'], // 25
    [18, '張'], // 26
    [18, '翼'], // 27
    [17, '軫'], // 28
```

改動主要在西方。<v>大衍</v>的赤度表一直沿用到宋代。<v>明天</v>重新定出一份表：

> 自漢太初後至唐開元治曆之初，凡八百年間，悉無更易。今雖測驗與舊不同，亦歲月未久。新曆兩備其數，如淳風從舊之意。

所以還是沿用以前的。直到北宋最後一部曆法<v>紀元</v>又做出調整：

```javascript
    [12, '角'], // 1 東蒼龍
    [9.25, '亢'], // 2
    [16, '氐'], // 3
    [5.75, '房'], // 4
    [6.25, '心'], // 5
    [19.25, '尾'], // 6
    [10.5, '箕'], // 7
    [25, '斗'], // 8 北玄武
    [7.25, '牛'], // 9
    [11.25, '女'], // 10
    [9, '虛'], // 11
    [15.5, '危'], // 12
    [17, '室'], // 13
    [8.75, '壁'], // 14
    [16.5, '奎'], // 15 西白虎
    [12, '婁'], // 16
    [15, '胃'], // 17
    [11.25, '昴'], // 18
    [17.25, '畢'], // 19
    [0.5, '觜'], // 20
    [10.5, '參'], // 21
    [33.25, '井'], // 22 南朱雀
    [2.5, '鬼'], // 23
    [13.75, '柳'], // 24
    [6.75, '星'], // 25
    [17.25, '張'], // 26
    [18.75, '翼'], // 27
    [17, '軫'], // 28
```

就這樣用了一百多年。直到<v>授時</v>給出了新的觀測結果：

```javascript
    [12.1, '角'], // 1 東蒼龍
    [9.2, '亢'], // 2
    [16.3, '氐'], // 3
    [5.6, '房'], // 4
    [6.5, '心'], // 5
    [19.1, '尾'], // 6
    [10.4, '箕'], // 7
    [25.2, '斗'], // 8 北玄武
    [7.2, '牛'], // 9
    [11.35, '女'], // 10
    [8.7, '虛'], // 11
    [15.4, '危'], // 12
    [17.1, '室'], // 13
    [8.6, '壁'], // 14
    [16.6, '奎'], // 15 西白虎
    [11.8, '婁'], // 16
    [15.6, '胃'], // 17
    [11.3, '昴'], // 18
    [17.4, '畢'], // 19
    [0.05, '觜'], // 20
    [10.1, '參'], // 21
    [33.3, '井'], // 22 南朱雀
    [2.2, '鬼'], // 23
    [13.3, '柳'], // 24
    [6.3, '星'], // 25
    [17.25, '張'], // 26
    [18.75, '翼'], // 27
    [17.3, '軫'], // 28
```

如果單從數字改變幅度來看的話，可見影響最深的是<v>太初</v>和<v>紀元</v>的赤度表。

而黃道觀測結果就變得頻繁得多，想看具體情況，可以看我的源代碼。

#### 斗分

「斗分」是什麼意思呢？歲實（回歸年長度）= 365 + 歲分 / 度法（當然，不同曆法有不同的名字），在文學語境（相對曆筭術語而言）中，歲分就叫斗分。《黃初》作者韓詡認爲《乾象》「減斗分太過，後當先天」，大槪就是比較早的出現「斗分」一詞的材料了。爲何要叫「斗分」？中國古代一週的度數是歲實，所以每部曆法都有各自的圓周度數，而我們看<v>太初</v>的赤度表，發現其中都是整數，沒有小數，這是怎麼回事？一般而言，小數點要加到斗宿的後面，所以叫 <b>斗分</b> ，曆法術語表述爲「經斗去分」。到了祖沖之將歲差引入曆法後，各曆上元日所在赤度一般在虛，所以小數點加在虛宿後面，卽「經虛去分」。因此唐代以後，「斗分」一詞就不再用了，否則就要叫「虛分」了。

### 黃道度

黃道度要由赤道度轉換而來，<v>乾象</v>開始給出了表格轉換法。