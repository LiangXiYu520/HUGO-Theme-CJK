---
author: ["柯棋瀚"]
title: "赫赫金鑰｜曆學三：後漢四分曆、授時曆"
date: 2021-01-11
categories: ["曆"]
series: ["赫赫金鑰"]
url: /tutorial/calendar3
description: '介紹了後漢《四分曆》、元《授時曆》。似乎跨度有點大。'
img: 'https://pic.imgdb.cn/item/5ffb9be73ffa7d37b3c6336c.jpg'
vertical: false
---

## 後漢四分曆

### 1.1

章帝元和二年（85）改行四分曆，文帝後元三年庚辰（前 161）爲入元之年。

- 【1 秊】365 1/4 = 1461/4 日，1461：周天，4：日法，1461 ÷ 3 = 487：通法。365 1/4 - 360 = 21/4
- 【1 章】19 秊設 7 閏月，235 月 6939 3/4 日。19：章法，7：章閏，235：章月。235 × 1461 = 343335：大周。每章日月相會 235 周，月行 254 周。( 1461/4 × 19 )/ 254 = 27759/1016 ≈ 27.3218（近點月），1016：月周
- 【1 蔀】4 章 76 秊 940 月 27759 日。76：蔀法，940：蔀月，27759：蔀日
- 【1 紀】20 蔀 1520 秊 18800 月。1520：紀法，18800：紀月
- 【1 元】3 紀4560 秊。4560：元法

距上元年數 % 4560 = 入元年數。入元年數 % 1520 = 入紀年數。入紀年數 % 76 = 入蔀年數。《三統曆》**算外** 爲所求年太歲所在，《四分曆》**算上** 爲所求年太歲所在，因爲《三統曆》上元以來年數不包括所求年，四分曆包括。

《殷曆》二十蔀首表（再友情提示一下，「天」「地」「人」一欄是歲名，「蔀首」一欄是日名）：

|          | **1** | **2** | **3** | **4** | **5** | **6** | **7** | **8** | **9** | **10** | **11** | **12** | **13** | **14** | **15** | **16** | **17** | **18** | **19** | **20** |
| -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| **蔀首** | 甲子  | 癸卯  | 壬午  | 辛酉  | 庚子  | 己卯  | 戊午  | 丁酉  | 丙子  | 乙卯   | 甲午   | 癸酉   | 壬子   | 辛卯   | 庚午   | 己酉   | 戊子   | 丁卯   | 丙午   | 乙酉   |
| **天元** | 甲寅  | 庚午  | 丙戌  | 壬寅  | 戊午  | 甲戌  | 庚寅  | 丙午  | 壬戌  | 戊寅   | 甲午   | 庚戌   | 丙寅   | 壬午   | 戊戌   | 甲寅   | 庚午   | 丙戌   | 壬寅   | 戊午   |
| **地元** | 甲戌  | 庚寅  | 丙午  | 壬戌  | 戊寅  | 甲午  | 庚戌  | 丙寅  | 壬午  | 戊戌   | 甲寅   | 庚午   | 丙戌   | 壬寅   | 戊午   | 甲戌   | 庚寅   | 丙午   | 壬戌   | 戊寅   |
| **人元** | 甲午  | 庚戌  | 丙寅  | 壬午  | 戊戌  | 甲寅  | 庚午  | 丙戌  | 壬寅  | 戊午   | 甲戌   | 庚寅   | 丙午   | 壬戌   | 戊寅   | 甲午   | 庚戌   | 丙寅   | 壬午   | 戊戌   |

後漢《四分曆》二十蔀首表：

|          | **1** | **2** | **3** | **4** | **5** | **6** | **7** | **8** | **9** | **10** | **11** | **12** | **13** | **14** | **15** | **16** | **17** | **18** | **19** | **20** |
| -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| **蔀首** | 甲子  | 癸卯  | 壬午  | 辛酉  | 庚子  | 己卯  | 戊午  | 丁酉  | 丙子  | 乙卯   | 甲午   | 癸酉   | 壬子   | 辛卯   | 庚午   | 己酉   | 戊子   | 丁卯   | 丙午   | 乙酉   |
| **天元** | 庚辰  | 丙申  | 壬子  | 戊辰  | 甲申  | 庚子  | 丙辰  | 壬申  | 戊子  | 甲辰   | 庚申   | 丙子   | 壬辰   | 戊申   | 甲子   | 庚辰   | 丙申   | 壬子   | 戊辰   | 甲申   |
| **地紀** | 庚子  | 丙辰  | 壬申  | 戊子  | 甲辰  | 庚申  | 丙子  | 壬辰  | 戊申  | 甲子   | 庚辰   | 丙申   | 壬子   | 戊辰   | 甲申   | 庚子   | 丙辰   | 壬申   | 戊子   | 甲辰   |
| **人紀** | 庚申  | 丙子  | 壬辰  | 戊申  | 甲子  | 庚辰  | 丙申  | 壬子  | 戊辰  | 甲申   | 庚子   | 丙辰   | 壬申   | 戊子   | 甲辰   | 庚申   | 丙子   | 壬辰   | 戊申   | 甲子   |

### 1.2

#### 1.2.1

1.2.1.1 【節氣】每年減去 6 甲子，餘 5 1/4 = 21/4 日。21：沒數。或 365 1/4 ÷ 24 = 15 7/32 ，7：沒法，32：中法。7 × 24 = 168：日餘，168 ÷ 32 = 5 1/4 = 21/4 日

1.2.1.2 【閏月位置】(19 - 閏餘) × 12/7 = 月數 <sup>餘數</sup>/<sub>7</sub> 。月數 + 1 卽閏月所在。若餘數 ≥ 4，則閏月可在前也可在後，由中氣決定，因爲閏月沒有中氣。例：餘數 = 5 ，6 月中氣爲大暑，若大暑在弟 6 月，則閏六月，若在弟 7 月，則閏五月

1.2.1.3 【弦望】每月 29 499/940 日，半月 14 719.5/940 日，四分之一月 7 359.75/940 日

1.2.1.4 【朔望時刻】每日分爲 100 刻，朔望小餘 × 100/940 = 刻數 <sup>刻餘</sup>/<sub>940</sub> 。所在節氣小於夜漏之半的在前日，大於的在後日

#### 1.2.2

1.2.2.1 【冬至日名】每年後退 21/4 位，69 4/7 = 487/7 日後退一位（一沒），4 秊 1461 日後退 21 位。487：通數。7 沒 = 1 滅，3 滅 = 4 秊。已知一沒求後一沒，大小餘分別加 69、4 卽可

1.2.2.2 【冬至積日大餘】(入蔀年 - 1) × 21/4 = 大餘 <sup>小餘</sup>/<sub>4</sub> 。算外。求次年冬至，則大餘 +5 ，小餘 +1 。每節氣相隔 15 7/32 日，大小餘分別相加卽可（注意分母是 32 而非 4）

1.2.2.3 【冬至**前**第一箇沒日】(入蔀年 - 1) × 21/4 = 積沒 <sup>沒餘</sup>/<sub>4</sub> 。積沒 × 69 4/7 = 大餘 <sup>小餘</sup>/<sub>7</sub> （記得是從蔀首日開始算大餘）

1.2.2.4 【天正】(入蔀年 - 1) × 235/19 = 積月 <sup>閏餘</sup>/<sub>19</sub>（同 [古代曆法入門之一](/163/) 4.2.1）。例：漢順帝永建五年（130）距入元之年 291 秊（含當年），291 ÷ 76 = 3 63/76 ，天紀弟 4 蔀辛酉弟 63 秊，算上爲庚午

1.2.2.5 【天正朔日】積月 × 27759/940 = [(入蔀年 - 1) ×343335 - 1461 閏餘] ÷ 940 = 積日 <sup>小餘</sup>/<sub>940</sub> ，積日 % 60 = 大餘。若小餘 ≥ 441 ，則爲大月

#### 1.2.3

1.2.3.1 【合朔日所在天度】積日 + <sup>小餘</sup>/<sub>940</sub> + 21.25 - 365.25n （單位：°，1° = 940′）

1.2.3.2 【朔日夜半日所在天度】積日 + 21.25 - 365.25n

次日夜半所在天度：+ 1°

1.2.3.3【朔日夜半月所在天度】日每日行 1°，月每日行 13 7/19 ° 。254/19 積日 + 21.25 - 365.25n（單位：°，1° = 76′）

次日夜半月所在天度：+ 13°28′ 。次月（大月）：+ 35°61′，次月（小月）：+ 22°33′

1.2.3.4【朔日黎明日所在天度】1.2.3.2 + 4.7 夜漏數

1.2.3.5【朔日昬日所在天度】1.2.3.2 + 76 - 4.7 夜漏數

1.2.3.5【朔日黎明月所在天度】1.2.3.3 + 50.08 夜漏數

## 授時曆

根據張培瑜《中國古代曆法》第649—653頁。

### 1、日行盈縮

太陽在冬至速度最快，夏至速度最慢。冬至到夏至的半歲爲盈曆，夏至到冬至爲縮曆。

秋正\_\_**縮末限** 88.909225日\_\_冬至\_\_**盈初限** 88.909225日\_\_春正\_\_**盈末限** 93.712025 日_\_夏至\_\_**縮初限** 93.712025日 秋正

縮末限、盈初限等分爲6段，每段約14.82日，各段積差爲段末實行度與平行度之差。積差/積日=日平差、盈加分，卽平均每日多走的分數。各段日平差與後段日平差相減爲一差，一差與後段一差相減爲二差。

|       | 積日                | 積差       | 日平差                     | 一差                       | 二差                          |
| ----- | ------------------- | ---------- | -------------------------- | -------------------------- | ----------------------------- |
| 冬至  | 0                   |            | 定差513.3822097763196113   | 泛平積差37.074492551251009 | 泛立積差=1.3801672436127973/2 |
| 第1段 | 14.8182041666666667 | 7058.0250  | 泛平積476.3077172250686023 | 38.4546597948638063        | 1.3801672436127973            |
| 第2段 | 29.6364083333333333 | 12976.3920 | 437.853057430204796        | 39.8348270384766036        |                               |
| 第3段 | 44.4546125          | 17693.7462 | 398.0182303917281924       |                            |                               |
| 第4段 |                     | 21148.7328 |                            |                            |                               |
| 第5段 |                     | 23279.9970 |                            |                            |                               |
| 第6段 |                     | 24026.1840 |                            |                            |                               |

【泛立積差】0.69008362180639865

【平差】 (泛平積差-泛立積差)/段日 = 2.45538585649203063124214613275506563014130423474055

【立差】 泛立積差/段日^2=0.00314275533037503126

夏至前後

|       | 積日                | 積差       | 日平差                     | 一差                        | 二差                          |
| ----- | ------------------- | ---------- | -------------------------- | --------------------------- | ----------------------------- |
| 夏至  | 0                   | 0          | 定差487.1014493604209279   | 泛平積差35.1429904539999003 | 泛立積差=1.3301131845139404/2 |
| 第1段 | 15.6186708333333333 | 7058.9904  | 泛平積451.9584589064210276 | 36.4731036385138407         | 1.3301131845139404            |
| 第2段 | 31.2373416666666667 | 12978.6580 | 415.4853552679071869       | 37.8032168230277811         |                               |
| 第3段 | 46.8560125          | 17696.6790 | 377.6821384448794058       |                             |                               |
| 第4段 |                     |            |                            |                             |                               |
| 第5段 |                     |            |                            |                             |                               |
| 第6段 |                     |            |                            |                             |                               |

【泛立積差】0.6650565922569702

【平差】 (泛平積差-泛立積差)/段日 = 2.20748194450453482997512859208836859517228445335591

【立差】 泛立積差/段日^2=0.002726280004867184

冬夏至後x日的日平差、盈縮差=定差x-平差x^2-立差x^3*10^-4

### 2、月行遲疾

一個近月點分為4個象，每象分為7段，每段分為12限，一轉周27.5546日有336限。每段0.9840928571428571日，每限0.0820077380952381日。

近地點開始，每象6.88865日



入轉日\_\_**疾初限**\_\_84限\_\_**疾末限**\_\_轉中168限13.7773日\_\_**遲初限**\_\_252限\_\_**遲末限**\_\_入轉日27.5546日

|       | 積限 | 積差分   | 限平差        | 一差           | 二差   |
| ----- | ---- | -------- | ------------- | -------------- | ------ |
| 初日  | 0    |          | 定差11.1100   | 泛平積差0.3840 | 0.0936 |
| 第1段 | 12   | 128.7120 | 泛平積10.7260 | 0.4776         | 0.0936 |
| 第2段 | 24   | 245.9616 | 10.2484       | 0.5712         |        |
| 第3段 | 36   | 348.3792 | 9.67720       |                |        |
| 第4段 | 48   | 432.5952 |               |                |        |
| 第5段 | 60   | 495.2400 |               |                |        |
| 第6段 | 72   | 532.9440 |               |                |        |
| 第7段 | 84   | 542.3376 |               |                |        |

泛立積差=0.0468

平差=0.0281

立差=0.000325

第x限遲疾積=定差x+平差x^2+立差x^3

遲疾差=定差x-平差x^2-立差x^3

### 3、參數

1281年辛巳爲曆元。

1日100刻，1刻100分，1分100秒，1秒100微。1秒=8.64s

【歲實、歲周】365.2425日=3652425分【半歲周】182.62125日【歲實消長】每百年歲實減少 0.0001日：365.2425 - 0.000001(公元年數-1281)【通餘、通盈分】歲實-360=5.2425日

【朔實、朔策】29.530593日【望策】朔策/2=14.7652965日【弦策】朔策/4=7.38264825日【朔虛】30-朔策=0.469407日

【歲閏、通閏】歲實-12朔策=10.875384日

【氣策】歲實/24=15.2184375日【氣盈】氣策-15=0.2184375日

【周天分】3652575分【周天度】365.2575度【周天象限】周天度/4=91.314375度

【歲差】周天-歲周=0.0150日

【轉終】27.5546日【轉中】13.7773日【轉差】朔實-轉終=1.975993日

【月平行度】13.36875度

【紀法】60【限法】820

【周限】轉終分/限法=275546/820=336.0317073170731707【中限】周限/2【初限】周限/4

【上弦】91.314375度【望】182.62875度【下弦】273.943125度

【氣應】55.06日：實測曆元歲前冬至爲己未子正夜半後6刻，距甲子夜半55.0600日

【閏應】20.205日：實測曆元歲前冬至距天正月平朔20.185日。至元三十一年（1294）改爲20.205日

【轉應】13.0205日：曆元歲前冬至距前月過近地點13.1904日。至元三十一年（1294）改爲13.0205日

【交應】26.0388日：曆元歲前冬至距前月過降交點26.018786日。至元三十一年（1294）改爲26.0388日。

【周應】315.1075度

### 4、氣朔閏

天正冬至：

中積=(年數-1281)*歲實365.2425

通積=中積+氣應55.06

冬至=通積%60，甲子算外。

閏積=中積+閏應20.205，閏餘=閏積%朔實29.530593，卽冬至平月齡、冬至距經朔的日數。

【天正經朔日分】冬至日分-閏餘。累加朔實，%60，得各月經朔。

冬至到夏至爲盈曆，夏至到冬至爲縮曆。【天正經朔入縮曆】182.62125-閏餘。累加朔實，%182.62125，得各月入盈縮曆。

若盈曆，若<=88.909225，卽為x；若>88.909225，半歲周182.62125-各月入盈縮曆=x 

若縮曆，若<=93.712025，卽爲x；若>93.712025，半歲周182.62125-各月入盈縮曆=x 

計算盈縮差（見上）盈縮差=定差x-平差x^2-立差x^3*10^-4，盈曆和縮曆參數不同

計算天正經朔入轉日分：(中積+轉應13.0205-閏餘)%轉終27.5546。累加轉差，%轉終27.5546，得各月經朔入轉日分。

經朔入轉日分<=轉中13.7773爲疾曆，>13.7773，減去轉中爲遲曆。

遲疾曆日分*12.20限，若<=84爲初限x，若>84，中限168-日分=末限x

遲疾差=定差x-平差x^2-立差x^3

加減差=盈縮差、遲疾差同名（盈遲、縮疾）相加，異名（盈疾、縮遲）相減 * 限法820 / 遲疾限下行度（遲疾限下行度=月平行度+-該限損益分）

經朔+加減差=定朔

求閏月

閏準=朔實-歲閏=18.655209日。月閏=歲閏10.875384/12=2*氣策-朔實=0.906282日

閏餘>=閏準，有閏月。天正冬至閏餘累加月閏，>=朔實的月就是閏月
